(this["webpackJsonpsocket-meet"]=this["webpackJsonpsocket-meet"]||[]).push([[0],{81:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(9),i=n.n(c),s=n(14),o=n(20),u=n(16),d=n.n(u),l=n(34),j=n(12),v=n(129),b=n(126),O=n(132),f=n(128),p=n(111),h=n(115),m=n(130),x=n(124),E=n(120),g=n(121),C=n(122),N=n(123),D=(n(80),new WebSocket("wss://p2p-be-dev.janus-demo.live")),_={JOIN_LOBBY:"JOIN_LOBBY",JOIN_LOBBY_ACK:"JOIN_LOBBY_ACK",GET_PEER_LIST:"GET_PEER_LIST",GET_PEER_LIST_ACK:"GET_PEER_LIST_ACK",PEER_LIST_CHANGED:"PEER_LIST_CHANGED",GET_STUN_TURN_INFO:"GET_STUN_TURN_INFO",GET_STUN_TURN_INFO_ACK:"GET_STUN_TURN_INFO_ACK",WEBRTC_OFFER:"WEBRTC_OFFER",WEBRTC_ANSWER:"WEBRTC_ANSWER",ICE_CANDIDATE:"ICE_CANDIDATE",CALL_STARTED:"CALL_STARTED",HANG_UP:"HANG_UP"},T=n(114),S=n(116),R=n(117),k=n(5),y=function(e){var t=e.users,n=e.myName,a=e.onSelectRecipient;return Object(k.jsx)(p.a,{container:!0,spacing:2,children:t.map((function(e){var t=e.name,r=e.status;return n===t?null:Object(k.jsx)(p.a,{item:!0,xs:"auto",children:Object(k.jsx)(T.a,{badgeContent:"ONLINE"===r?"online":"offline",color:"ONLINE"===r?"primary":"secondary",children:Object(k.jsx)(h.a,{style:{borderRadius:8},onClick:function(){return a(t)},children:Object(k.jsx)(S.a,{component:f.a,p:2,children:Object(k.jsx)(R.a,{children:t})})})})},t)}))})},I={variant:"contained",color:"primary"},A=function(e){var t=e.value,n=e.options,a=e.type,r=e.onChangeDevice;return Object(k.jsxs)(b.a,{value:t,displayEmpty:!0,fullWidth:!0,variant:"outlined",onChange:function(e){"volume"!==a?r(a,e.target.value):r(e.target.value)},children:[Object(k.jsx)(O.a,{value:"",disabled:!0,children:"Select device"}),n.map((function(e){var t=e.deviceId,n=e.label;return Object(k.jsx)(O.a,{value:t,children:n},t)}))]})},L=function(e,t){if(1!==e.length){var n=e.filter((function(e){return"default"===e.deviceId}));t(Object(j.a)(n,1)[0].deviceId)}else{t(Object(j.a)(e,1)[0].deviceId)}},B=new RTCPeerConnection({iceServers:[{urls:["stun:stun.l.google.com:19302"]}]}),w=function(){var e=r.a.useRef(null),t=r.a.useRef(null),n=r.a.useRef(null),a=r.a.useState("".concat(Object(v.a)().slice(0,4),"@").concat(Object(v.a)().slice(0,4))),c=Object(j.a)(a,2),i=c[0],u=c[1],b=r.a.useState(""),O=Object(j.a)(b,2),f=O[0],p=O[1],h=r.a.useState(null),m=Object(j.a)(h,2),x=m[0],E=m[1],g=r.a.useState([]),C=Object(j.a)(g,2),N=C[0],T=C[1],S=r.a.useState([]),R=Object(j.a)(S,2),k=R[0],y=R[1],I=r.a.useState([]),A=Object(j.a)(I,2),w=A[0],F=A[1],U=r.a.useState(""),J=Object(j.a)(U,2),W=J[0],P=J[1],G=r.a.useState(""),V=Object(j.a)(G,2),K=V[0],H=V[1],Y=r.a.useState(""),M=Object(j.a)(Y,2),q=M[0],z=M[1],Q=r.a.useState([]),X=Object(j.a)(Q,2),Z=X[0],$=X[1],ee=r.a.useState({video:!0,audio:!0}),te=Object(j.a)(ee,2),ne=te[0],ae=te[1],re=function(){var t=Object(l.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.mediaDevices.getUserMedia(n);case 2:if(a=t.sent,E(a),e.current){t.next=6;break}return t.abrupt("return");case 6:a.getTracks().forEach((function(e){return B.addTrack(e,a)})),e.current.srcObject=a;case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ce=function(){var e=Object(l.a)(d.a.mark((function e(){var t,n,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:t=e.sent,n=t.filter((function(e){return"audioinput"===e.kind})),a=t.filter((function(e){return"audiooutput"===e.kind})),r=t.filter((function(e){return"videoinput"===e.kind})),L(n,H),L(a,z),L(r,P),T(r),F(a),y(n);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=Object(l.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.createOffer({offerToReceiveVideo:!0});case 2:return t=e.sent,e.next=5,B.setLocalDescription(t);case 5:a={type:_.WEBRTC_OFFER,data:t,sender:i,recipient:f},n.current=f,D.send(JSON.stringify(a));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(){var e=Object(l.a)(d.a.mark((function e(t,n){var a,r,c,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(o.a)(Object(o.a)({},ne),{},Object(s.a)({},t,{deviceId:{exact:n}})),e.next=3,navigator.mediaDevices.getUserMedia(a);case 3:if(r=e.sent,c=r.getTracks().find((function(e){return e.kind===t}))){e.next=7;break}return e.abrupt("return");case 7:if(i=B.getSenders().find((function(e){return e.track.kind===c.kind}))){e.next=10;break}return e.abrupt("return");case 10:i.replaceTrack(c),e.t0=t,e.next="audio"===e.t0?14:"video"===e.t0?16:18;break;case 14:return H(n),e.abrupt("break",19);case 16:return P(n),e.abrupt("break",19);case 18:return e.abrupt("break",19);case 19:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return r.a.useEffect((function(){B.addEventListener("icecandidate",(function(e){var t=e.candidate;if(t){var a={type:_.ICE_CANDIDATE,data:t,sender:i,recipient:n.current};D.send(JSON.stringify(a))}})),B.addEventListener("track",(function(e){var n=e.streams;if(t.current){var a=Object(j.a)(n,1)[0];t.current.srcObject!==a&&(t.current.srcObject=a)}})),ce().then((function(){re(ne)})),navigator.mediaDevices.addEventListener("devicechange",ce),D.addEventListener("message",function(){var e=Object(l.a)(d.a.mark((function e(t){var a,r,c,s,o,u,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=JSON.parse(t.data),r=a.type,c=a.data,s=a.sender,o=a.recipient,r===_.PEER_LIST_CHANGED&&$(c.users),r!==_.WEBRTC_OFFER||s===i){e.next=13;break}return n.current=s,e.next=6,B.setRemoteDescription(c);case 6:return e.next=8,B.createAnswer();case 8:return u=e.sent,e.next=11,B.setLocalDescription(u);case 11:l={type:_.WEBRTC_ANSWER,data:u,sender:o,recipient:s},D.send(JSON.stringify(l));case 13:if(r!==_.WEBRTC_ANSWER||s===i){e.next=16;break}return e.next=16,B.setRemoteDescription(c);case 16:console.log(r),r===_.ICE_CANDIDATE&&B.addIceCandidate(c);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),{peer:B,senderName:i,handleChangeSenderName:function(e){return u(e.target.value)},recipientName:f,handleSelectRecipient:function(e){return p(e)},videoRef:e,remoteVideoRef:t,isVideoOn:ne.video,isAudioOn:ne.audio,handleToggleDevicesStatus:function(e){return function(){return ae((function(t){var n=Object(o.a)(Object(o.a)({},t),{},Object(s.a)({},e,!t[e]));return x.getTracks().forEach((function(t){t.kind===e&&(t.enabled=!t.enabled)})),n}))}},selectedVideoDevice:W,selectedMicrophoneDevice:K,selectedVolumeDevice:q,handleChangeDevice:se,handleChangeOutputDevice:function(t){e.current&&(z(t),e.current.setSinkId(t))},localeStream:x,videoDevices:N,microphoneDevices:k,volumeDevices:w,joinedUsers:Z,handleCall:ie,handleJoinLobby:function(){var e={type:_.JOIN_LOBBY,data:"",sender:i,recipient:""};D.send(JSON.stringify(e))}}},F=function(){var e=w();return Object(k.jsxs)(f.a,{p:2,children:[Object(k.jsxs)(p.a,{container:!0,spacing:2,justify:"center",children:[Object(k.jsx)(p.a,{item:!0,xs:6,children:Object(k.jsx)("video",{autoPlay:!0,ref:e.videoRef,style:{width:"100%",height:"100%"}})}),Object(k.jsx)(p.a,{item:!0,xs:6,children:Object(k.jsx)("video",{autoPlay:!0,ref:e.remoteVideoRef,style:{width:"100%",height:"100%"}})}),Object(k.jsxs)(p.a,{item:!0,xs:12,container:!0,spacing:2,justify:"center",children:[Object(k.jsx)(p.a,{item:!0,xs:"auto",children:Object(k.jsx)(h.a,{onClick:e.handleToggleDevicesStatus("video"),children:e.isVideoOn?Object(k.jsx)(E.a,{color:"primary"}):Object(k.jsx)(g.a,{color:"error"})})}),Object(k.jsx)(p.a,{item:!0,xs:"auto",children:Object(k.jsx)(h.a,{onClick:e.handleToggleDevicesStatus("audio"),children:e.isAudioOn?Object(k.jsx)(C.a,{color:"primary"}):Object(k.jsx)(N.a,{color:"error"})})})]}),Object(k.jsxs)(p.a,{item:!0,xs:12,container:!0,spacing:2,children:[Boolean(e.microphoneDevices.length)&&Object(k.jsxs)(p.a,{item:!0,xs:4,children:["microphoneDevices",Object(k.jsx)(A,{value:e.selectedMicrophoneDevice,type:"audio",options:e.microphoneDevices,onChangeDevice:e.handleChangeDevice})]}),Boolean(e.videoDevices.length)&&Object(k.jsxs)(p.a,{item:!0,xs:4,children:["videoDevices",Object(k.jsx)(A,{value:e.selectedVideoDevice,type:"video",options:e.videoDevices,onChangeDevice:e.handleChangeDevice})]}),Boolean(e.volumeDevices.length)&&Object(k.jsxs)(p.a,{item:!0,xs:4,children:["volumeDevices",Object(k.jsx)(A,{value:e.selectedVolumeDevice,type:"volume",options:e.volumeDevices,onChangeDevice:e.handleChangeOutputDevice})]})]}),Object(k.jsx)(p.a,{item:!0,xs:12,children:Object(k.jsx)(m.a,{value:e.senderName,onChange:e.handleChangeSenderName,variant:"outlined",fullWidth:!0,autoFocus:!0,disabled:Boolean(e.joinedUsers.find((function(t){return t.name===e.senderName})))})}),Object(k.jsx)(p.a,{item:!0,xs:"auto",children:Object(k.jsxs)(x.a,Object(o.a)(Object(o.a)({},I),{},{onClick:e.handleCall,disabled:!e.recipientName,children:["Call ",e.recipientName&&"to ".concat(e.recipientName)]}))}),Object(k.jsx)(p.a,{item:!0,xs:"auto",children:Object(k.jsx)(x.a,Object(o.a)(Object(o.a)({},I),{},{onClick:e.handleJoinLobby,disabled:!e.senderName||Boolean(e.joinedUsers.find((function(t){return t.name===e.senderName}))),children:Boolean(e.joinedUsers.find((function(t){return t.name===e.senderName})))?"Joined":"Join"}))})]}),Object(k.jsx)(y,{users:e.joinedUsers,myName:e.senderName,onSelectRecipient:e.handleSelectRecipient})]})},U=n(125),J=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,134)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};i.a.render(Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(U.a,{}),Object(k.jsx)(F,{})]}),document.getElementById("root")),J()}},[[81,1,2]]]);
//# sourceMappingURL=main.cff3f43c.chunk.js.map